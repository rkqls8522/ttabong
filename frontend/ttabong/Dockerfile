# ğŸ”¹ 1ë‹¨ê³„: React ë¹Œë“œ (builder ìŠ¤í…Œì´ì§€)
FROM node:20 AS builder
WORKDIR /app

# package.jsonê³¼ package-lock.jsonë§Œ ë¨¼ì € ë³µì‚¬ í›„ ì˜ì¡´ì„± ì„¤ì¹˜
COPY package*.json ./
RUN npm install

# ì „ì²´ í”„ë¡œì íŠ¸ ë³µì‚¬
COPY . .

# React ë¹Œë“œ ì‹¤í–‰
RUN npm run build

# ë¹Œë“œ ê²°ê³¼ í™•ì¸
RUN ls -l build  

# ğŸ”¹ 2ë‹¨ê³„: Nginx ìŠ¤í…Œì´ì§€
FROM nginx:alpine
WORKDIR /usr/share/nginx/html

# âœ… ë¹Œë“œëœ `build` í´ë”ë¥¼ ì œëŒ€ë¡œ ë³µì‚¬
COPY --from=builder /app/build/ /usr/share/nginx/html 

# âœ… Nginx ì„¤ì • íŒŒì¼ì„ Dockerfileë¡œ ë³µì‚¬
COPY ./nginx.conf /etc/nginx/nginx.conf

# âœ… Nginx ì‹¤í–‰
CMD ["nginx", "-g", "daemon off;"]
